function setCookie(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="expires="+d.toGMTString();document.cookie=a+"="+b+"; "+e}function getCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""}function checkCookie(){var a=getCookie("sortby");sortType=a,window.setTimeout(sortTable,500)}var articleArray=[],visibleRows=0,articleCount=0,extraRows=0,load=10,sortType,articlesTable="#articlesTable",loader=function(){function a(){$("#loader").fadeOut(500),setTimeout(updateSortTable,1e3)}setTimeout(a,800)},countRows=function(){visibleRows=$("tr.row").length,extraRows=$("tr.extra").length},initialLoad=function(){$.get("/loadarticles",function(a){buildRows(a,"")})},loadSet2=function(){$.get("/morearticles",function(a){buildRows(a,"extra")}),window.setTimeout(updateSortTable,1e3)},buildRows=function(a,b){articleCount+=a.length;for(var c=0;c<a.length;c++){var d;d=""==a[c].image||null==a[c].image?"./assets/img/placeholderthumb.gif":a[c].image;var e="<tr class='row "+b+"'><td><div class='thumbnailContainer'><a href='"+a[c].url+"' target='_blank'><img src='"+d+"' alt='"+a[c].tags[0].name+"'></a></div> <a href='"+a[c].url+"' target='_blank'>"+a[c].title+"</a></td><td class='author'>"+a[c].profile.first_name+" "+a[c].profile.last_name+"</td><td class='words'>"+a[c].words+"</td><td class='date'><span>"+a[c].publish_at+"</span> "+a[c].time_ago+"</td></tr>";articleArray.push(e)}addArticles(load)},addArticles=function(a){countRows();var b=visibleRows+a,c=articleArray.slice(visibleRows,b);$("tbody").append(c),window.setTimeout(updateSortTable,500)},moreButton=function(){$("#btnLoadMore").click(function(){countRows();var a=articleCount-load;visibleRows==a&&extraRows>0&&$("#btnLoadMore").hide(),visibleRows<articleCount&&0==extraRows?addArticles(load):(visibleRows=articleCount)&&0==extraRows?loadSet2():visibleRows<=articleCount&&extraRows>0&&addArticles(load)})},sortTable=function(){$(articlesTable).tablesorter({headers:{0:{sorter:!1},1:{sorter:!1}},textExtraction:{".date":function(a,b,c){return $(a).find("span").text()}},widgets:["zebra"],widgetOptions:{zebra:["even","odd"]}}),callSortCookie()},updateSortTable=function(){var a=!0,b=function(){};$(articlesTable).trigger("updateAll",[a,b])},callSortCookie=function(){var a;"words-desc"==sortType?(a=[[2,1]],$("#header-words").addClass("down")):"words-asc"==sortType?(a=[[2,0]],$("#header-words").addClass("up")):"date-desc"==sortType?(a=[[3,1]],$("#header-date").addClass("down")):"date-asc"==sortType?(a=[[3,0]],$("#header-date").addClass("up")):(a=[[null,null]],$("#header-date, #header-words").addClass("down")),$(articlesTable).trigger("sorton",[a])};$("#header-words").click(function(){$(this).is(".up")?(setCookie("sortby","words-desc",365),$(this).removeClass("start").removeClass("up").addClass("down")):(setCookie("sortby","words-asc",365),$(this).removeClass("down").addClass("up"))}),$("#header-date").click(function(){$(this).is(".up")?(setCookie("sortby","date-desc",365),$(this).removeClass("start").removeClass("up").addClass("down")):(setCookie("sortby","date-asc",365),$(this).removeClass("down").addClass("up"))}),loader(),initialLoad(),checkCookie(),moreButton();